// Prisma schema for Quality Drive pages

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Page categories enum
enum PageCategory {
  RIJSCHOOL_AUTO    // rijschool-{stad} pages
  RIJSCHOOL_MOTOR   // motor rijschool pages
  RIJSCHOOL_TAXI    // taxi rijles pages
  RIJSCHOOL_AUTOMAAT // automaat rijles pages
  THEORIE           // theory pages
  BLOG              // blog posts
  CONTACT           // contact page
  ABOUT             // about pages
  GENERAL           // other pages
}

// Location/City model
model Location {
  id        Int      @id @default(autoincrement())
  name      String   @unique // e.g., "Den Haag", "Zoetermeer"
  slug      String   @unique // e.g., "den-haag", "zoetermeer"

  // Relations
  pages          Page[]
  autorijlesStad AutorijlesStad?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([slug])
}

// Main Page model
model Page {
  id            Int          @id @default(autoincrement())
  wordpressId   Int?         @unique // Original WordPress ID
  slug          String       @unique
  title         String
  content       String       @db.Text // HTML content
  excerpt       String?      @db.Text // Short description

  // Categorization
  category      PageCategory @default(GENERAL)

  // Location relation (for city-specific pages)
  location      Location?    @relation(fields: [locationId], references: [id])
  locationId    Int?

  // Media
  featuredImage String?

  // SEO
  seoTitle      String?
  seoDescription String?
  seoKeywords   String?

  // Meta
  originalUrl   String?
  publishedAt   DateTime?

  // Page hierarchy
  parentId      Int?
  parent        Page?        @relation("PageHierarchy", fields: [parentId], references: [id], onDelete: SetNull)
  children      Page[]       @relation("PageHierarchy")

  // Timestamps
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt

  @@index([slug])
  @@index([category])
  @@index([locationId])
  @@index([category, locationId])
}

// Gestructureerde autorijles stad pagina's
model AutorijlesStad {
  id        Int      @id @default(autoincrement())

  // Relatie met locatie
  location   Location @relation(fields: [locationId], references: [id])
  locationId Int      @unique

  // Hero Sectie
  heroTitle           String   // "Rijschool Den Haag"
  heroSubtitle        String   @db.Text // "Professionele rijlessen..."
  heroImage           String?  // URL naar hero image
  heroButtonText      String   @default("Gratis proefles plannen")
  heroButtonLink      String   @default("https://calendly.com/qualitydrive/30min")

  // Introductie Sectie
  introTitle          String?  // "Autorijlessen in Den Haag"
  introText           String?  @db.Text // Introductie paragraaf

  // Features/USPs (JSON array)
  // [{ "title": "Gratis proefles", "description": "...", "icon": "gift" }]
  features            Json?

  // Waarom Quality Drive sectie
  whyTitle            String   @default("Waarom kiezen voor Quality Drive?")
  whyText             String?  @db.Text
  whyPoints           Json?    // [{ "title": "Ervaren instructeurs", "description": "..." }]

  // Pakketten sectie
  showPricing         Boolean  @default(true)
  pricingTitle        String   @default("Rijles pakketten")
  pricingSubtitle     String?
  packages            Json?    // [{ "name": "Basis", "price": 1099, "lessons": 20, "features": [] }]

  // Lokale info
  localTitle          String?  // "Rijlessen in [Stad]"
  localText           String?  @db.Text // Stad-specifieke informatie
  examLocation        String?  // "CBR Examenlokatie"
  popularRoutes       Json?    // ["Route 1", "Route 2"]

  // Testimonials
  showTestimonials    Boolean  @default(true)
  testimonials        Json?    // [{ "name": "Jan", "text": "...", "rating": 5, "image": "..." }]

  // FAQ
  showFaq             Boolean  @default(true)
  faqTitle            String   @default("Veelgestelde vragen")
  faqs                Json?    // [{ "question": "...", "answer": "..." }]

  // CTA Sectie
  ctaTitle            String   @default("Start vandaag nog!")
  ctaText             String   @db.Text
  ctaButtonText       String   @default("Gratis proefles plannen")
  ctaButtonLink       String   @default("https://calendly.com/qualitydrive/30min")
  ctaImage            String?  // Background image voor CTA

  // Statistieken
  studentCount        Int?     // "Aantal geslaagde leerlingen"
  successRate         Float?   // "Slagingspercentage"
  yearsActive         Int?     // "Jaar actief"
  instructorCount     Int?     // "Aantal instructeurs"

  // SEO
  seoTitle            String
  seoDescription      String   @db.Text
  seoKeywords         String?
  ogImage             String?  // Open Graph image

  // Status
  isPublished         Boolean  @default(true)
  publishedAt         DateTime?

  // Timestamps
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt

  @@index([locationId])
  @@index([isPublished])
}
